# 52. N皇后 II
n 皇后问题研究的是如何将 n 个皇后放置在 n×n 的棋盘上，并且使皇后彼此之间不能相互攻击。

![](./q52_1.png)

上图为 8 皇后问题的一种解法。

给定一个整数 n，返回 n 皇后不同的解决方案的数量。

示例:

输入: 4
输出: 2
解释: 4 皇后问题存在如下两个不同的解法。
[
 [".Q..",  // 解法 1
  "...Q",
  "Q...",
  "..Q."],

 ["..Q.",  // 解法 2
  "Q...",
  "...Q",
  ".Q.."]
]
 

提示：

皇后，是国际象棋中的棋子，意味着国王的妻子。皇后只做一件事，那就是“吃子”。当她遇见可以吃的棋子时，就迅速冲上去吃掉棋子。当然，她横、竖、斜都可走一或 N-1 步，可进可退。（引用自 百度百科 - 皇后 ）


# 用例
```

```

# 题解


## 解法1
位运算

遍历可以放置皇后的位置时，可以利用以下两个按位与运算的性质：

- x & (−x) 可以获得 x 的二进制表示中的最低位的 1 的位置；

- x & (x−1) 可以将 x 的二进制表示中的最低位的 1 置成 0。


## 解法2
利用集合

记录列的位置 是 行与列相等

记录左上到右下斜线是 行-列

记录左下到右上斜线是 行+列


下标i是循环的列下标
当columns.find(i) 找得到时，continue
当columns.find(row-i) 找得到时，continue
当columns.find(row+i) 找得到时，continue

否则继续递归下一行

columns.insert(i)
diagonals.insert(row-i)
diagonals.insert(row+i)

count += backtrace(n,row+1,columns,diagonals1,diagonals2)



小结
回顾这道题，拿到这道题的时候，其实我们很容易看出需要使用枚举的方法来求解这个问题，当我们不知道用什么办法来枚举是最优的时候，可以从下面三个方向考虑：

- 子集枚举：可以把问题转化成「从 n^2 个格子中选一个子集，使得子集中恰好有 n 个格子，且任意选出两个都不在同行、同列或者同对角线」，这里枚举的规模是 2^{n^2} ；

- 组合枚举：可以把问题转化成「从 n^2 个格子中选择 n 个，且任意选出两个都不在同行、同列或者同对角线」，这里的枚举规模是 C(n^2,n)（排列组合那个C，表示从n^2个里选n）
​
- 排列枚举：因为这里每行只能放置一个皇后，而所有行中皇后的列号正好构成一个 1 到 n 的排列，所以我们可以把问题转化为一个排列枚举，规模是 n!。

带入一些 n 进这三种方法验证，就可以知道哪种方法的枚举规模是最小的，这里我们发现第三种方法的枚举规模最小。这道题给出的两个方法其实和排列枚举的本质是类似的。





> https://leetcode-cn.com/problems/n-queens-ii/solution/nhuang-hou-ii-by-leetcode-solution/